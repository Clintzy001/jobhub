<!DOCTYPE html>
<html lang="en" id="htmlTag">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JOBHUB | Market</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --brand: #4A148C; --brand-light: #7B1FA2; --off-white: #F9F9F9; }
        body { background-color: var(--off-white); font-family: sans-serif; transition: background-color 0.3s, color 0.3s; }
        
        .dark { background-color: #121212; color: white; }
        .dark .bg-white { background-color: #1E1E1E; }
        .dark .icon-label { color: #ccc; }
        .dark .icon-box { background-color: #222; }
        .dark .terms-box { background-color: #1a1a1a; border-color: #333; }

        .slogan-text {
            font-family: 'Arial Black', sans-serif;
            font-weight: 900; font-style: italic; letter-spacing: -1px;
            background: linear-gradient(to right, #FFFFFF 20%, #E1BEE7 40%, #BA68C8 50%, #E1BEE7 60%, #FFFFFF 80%);
            background-size: 200% auto; -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            animation: shine 3s linear infinite;
        }

        @keyframes shine { to { background-position: 200% center; } }

        .price-text { color: #2E7D32; font-size: 1.4rem; font-weight: 900; }
        .dark .price-text { color: #4ADE80; }

        .search-container { margin: -25px 20px 0 20px; position: relative; z-index: 60; }
        .search-input {
            width: 100%; padding: 14px 45px 14px 45px; border-radius: 20px; border: none;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); outline: none; font-size: 14px; background: white;
        }
        .dark .search-input { background: #2D2D2D; color: white; box-shadow: 0 10px 25px rgba(0,0,0,0.3); }
        
        #clearSearch { display: none; position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: #999; cursor: pointer; padding: 5px; }

        /* SECURITY LOCK FOR BUY BUTTONS */
        .buy-btn {
            width: 100%; py: 2.5; background-color: #25D366; color: white; 
            font-size: 10px; font-weight: 900; border-radius: 12px; 
            text-transform: uppercase; transition: all 0.3s;
            opacity: 0.3; cursor: not-allowed;
            display: flex; align-items: center; justify-content: center; gap: 5px; height: 40px;
        }
        .buy-btn.active { opacity: 1; cursor: pointer; box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3); }

        .featured-banner {
            background: linear-gradient(135deg, #4A148C 0%, #7B1FA2 100%);
            border-radius: 24px; padding: 20px; margin: 0 16px 20px 16px; color: white; position: relative; overflow: hidden;
        }
        .featured-scroll { display: flex; gap: 15px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; }
        
        .seller-badge {
            flex: 0 0 110px; background: rgba(255,255,255,0.1); padding: 12px;
            border-radius: 20px; text-align: center; border: 1px solid rgba(255,255,255,0.2); position: relative;
        }
        
        .badge-img-container {
            width: 55px; height: 55px; background: rgba(255,255,255,0.2); 
            border-radius: 50%; margin: 0 auto 8px auto; overflow: hidden;
            display: flex; align-items: center; justify-content: center;
            border: 2px solid rgba(255,255,255,0.5); position: relative;
        }
        .badge-img-container img { width: 100%; height: 100%; object-fit: cover; }
        
        /* ADMIN CONTROLS */
        .upload-input { display: none; position: absolute; inset: 0; opacity: 0; cursor: pointer; z-index: 10; }
        .reset-btn { 
            display: none; position: absolute; top: -5px; right: -5px; 
            background: #ff4444; color: white; width: 18px; height: 18px; 
            border-radius: 50%; font-size: 10px; align-items: center; justify-content: center; 
            z-index: 20; border: 1px solid white;
        }
        .admin-active .upload-input { display: block; }
        .admin-active .reset-btn { display: flex; }

        /* MODAL ANIMATION */
        #modalOverlay { transition: opacity 0.3s ease; }
        #agreeModal { transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); transform: translateY(100%); }
        #agreeModal.active { transform: translateY(0); }

        .agreement-row {
            display: flex; align-items: center; gap: 10px; margin-top: 15px;
            padding: 12px; border: 2px solid #eee; border-radius: 12px;
        }
        .dark .agreement-row { border-color: #333; }
        #agreeCheck { width: 22px; height: 22px; accent-color: #4A148C; cursor: pointer; }
    </style>
</head>
<body class="pb-32">

    <header class="bg-brand p-5 pb-12 space-y-6 shadow-lg sticky top-0 z-50 rounded-b-[35px] bg-[#4A148C]">
        <div class="flex justify-between items-center text-white">
            <h1 class="font-black italic text-2xl tracking-tighter">JOBHUB</h1>
            <button onclick="toggleDarkMode()" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center">
                <i class="fas fa-moon" id="themeIcon"></i>
            </button>
        </div>
        <div class="text-center py-2">
            <h2 class="slogan-text text-xl uppercase">KANO SHOPPING MADE EASY</h2>
        </div>
    </header>

    <div class="search-container">
        <i class="fas fa-search absolute left-5 top-1/2 -translate-y-1/2 text-gray-400"></i>
        <input type="text" id="searchInput" onkeyup="searchProducts()" placeholder="Search in Kano Market..." class="search-input">
        <i class="fas fa-times-circle" id="clearSearch" onclick="clearSearch()"></i>
    </div>

    <section class="mt-8" id="featuredSection">
        <div class="featured-banner shadow-xl">
            <div class="flex justify-between items-center mb-4">
                <h3 id="adminLabel" onclick="handleAdminTrigger()" class="font-black uppercase text-[12px] tracking-widest italic cursor-pointer select-none">
                    <i class="fas fa-star text-yellow-400 mr-2"></i>Top Sellers
                </h3>
                <span id="adminStatus" class="text-[9px] bg-white/20 px-2 py-1 rounded-full uppercase font-bold tracking-tighter">Verified Only</span>
            </div>
            <div class="featured-scroll">
                <div class="seller-badge">
                    <div class="badge-img-container">
                        <button class="reset-btn" onclick="resetBadge('seller1')"><i class="fas fa-times"></i></button>
                        <input type="file" class="upload-input" onchange="previewBadge(this, 'seller1')">
                        <i id="seller1-icon" class="fas fa-crown text-yellow-400 text-xl"></i>
                        <img id="seller1-img" src="" class="hidden">
                    </div>
                    <p id="seller1-name" class="seller-name text-[10px] font-black uppercase truncate mb-1">Alhaji Store</p>
                    <button class="bg-black text-white text-[8px] px-3 py-1 rounded-full dark:bg-white dark:text-black">Shop</button>
                </div>
            </div>
        </div>
    </section>

    <main class="px-4">
        <div id="noResults" class="hidden flex-col items-center py-10">
            <i class="fas fa-search text-4xl text-gray-300 mb-2"></i>
            <p class="text-gray-400 text-xs font-bold">NO ITEMS FOUND</p>
        </div>
        <div id="shopGrid" class="grid grid-cols-2 gap-4"></div>

        <div class="terms-box dark:bg-zinc-900 dark:border-zinc-800 p-6 rounded-3xl mt-10 border bg-white">
            <h4 class="font-black uppercase mb-3 text-brand dark:text-purple-400 flex items-center gap-2">
                <i class="fas fa-shield-alt"></i> Security Agreement
            </h4>
            <p class="text-[10px] text-gray-500 leading-relaxed">
                By clicking buy, you agree to verify all products before making payments. JOBHUB acts only as a connector between you and Kano sellers.
            </p>
            
            <div class="agreement-row" id="agreementContainer">
                <input type="checkbox" id="agreeCheck" onchange="toggleBuyButtons()">
                <label for="agreeCheck" class="font-bold text-gray-700 dark:text-gray-300 uppercase text-[9px]">I Understand & Agree to the safety rules</label>
            </div>
        </div>
    </main>

    <div id="modalOverlay" class="fixed inset-0 bg-black/60 z-[100] hidden items-end">
        <div id="agreeModal" class="bg-white dark:bg-zinc-900 w-full rounded-t-[30px] p-8 shadow-2xl">
            <div class="w-12 h-1 bg-gray-300 mx-auto mb-6 rounded-full"></div>
            <div class="text-center">
                <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-lock text-brand text-2xl"></i>
                </div>
                <h3 class="font-black text-xl mb-2 text-gray-800 dark:text-white">Secure Market Access</h3>
                <p class="text-sm text-gray-500 mb-6">To protect our community in Kano, please confirm you agree to verify sellers before paying.</p>
                <button onclick="acceptFromModal()" class="w-full py-4 bg-brand text-white font-black rounded-2xl shadow-lg uppercase tracking-wider bg-[#4A148C]">
                    I Agree & Shop
                </button>
                <button onclick="closeModal()" class="mt-4 text-gray-400 font-bold text-xs uppercase">Not now</button>
            </div>
        </div>
    </div>

    <nav class="fixed bottom-0 w-full bg-white border-t flex justify-around items-center py-4 z-50 dark:bg-[#1E1E1E] dark:border-zinc-800">
        <a href="#" class="flex flex-col items-center text-[#4A148C]"><i class="fas fa-store text-xl"></i><span class="text-[10px] font-bold">Market</span></a>
        <div onclick="window.open('https://wa.me/2347051337399')" class="flex flex-col items-center text-gray-400 cursor-pointer"><i class="fab fa-whatsapp text-xl"></i><span class="text-[10px] font-bold">Chat</span></div>
    </nav>

    <script>
        const myWhatsApp = "2347051337399";
        let isDarkMode = false;
        let clickCount = 0;
        let clickTimer;
        let pendingItem = null;

        window.addEventListener('load', () => {
            renderShop();
            loadAdminData();
            // Trigger popup if first time this session
            if (!sessionStorage.getItem('jh_safety_agreed')) {
                setTimeout(openModal, 1500);
            } else {
                document.getElementById('agreeCheck').checked = true;
                toggleBuyButtons();
            }
        });

        function renderShop(filter = '') {
            const grid = document.getElementById('shopGrid');
            const noRes = document.getElementById('noResults');
            grid.innerHTML = '';
            const items = ["iPhone 13", "MacBook Air", "Designer Shoe", "Nike Tech", "PS5 Console", "Smart Watch", "Powerbank", "Wireless Pods"];
            const isTicked = document.getElementById('agreeCheck')?.checked;
            
            let found = 0;
            items.forEach((name, i) => {
                if (name.toLowerCase().includes(filter.toLowerCase())) {
                    found++;
                    const price = (i + 1) * 4500;
                    grid.innerHTML += `
                    <div class="bg-white p-3 rounded-3xl shadow-md border dark:bg-zinc-900 dark:border-zinc-800">
                        <div class="h-32 bg-gray-100 rounded-2xl mb-2 flex items-center justify-center overflow-hidden">
                            <img src="https://via.placeholder.com/200?text=${name}" class="w-full h-full object-cover">
                        </div>
                        <h3 class="text-[11px] font-bold truncate mb-1 dark:text-white">${name}</h3>
                        <div class="price-text mb-2 text-sm">â‚¦${price.toLocaleString()}</div>
                        <button onclick="buyProduct('${name}', '${price}')" class="buy-btn ${isTicked ? 'active' : ''}">
                            <i class="fab fa-whatsapp"></i> Buy Now
                        </button>
                    </div>`;
                }
            });
            noRes.style.display = found === 0 ? "flex" : "none";
        }

        function searchProducts() {
            const val = document.getElementById('searchInput').value;
            document.getElementById('clearSearch').style.display = val ? 'block' : 'none';
            renderShop(val);
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            searchProducts();
        }

        function toggleBuyButtons() {
            const isTicked = document.getElementById('agreeCheck').checked;
            if(isTicked) sessionStorage.setItem('jh_safety_agreed', 'true');
            document.querySelectorAll('.buy-btn').forEach(btn => isTicked ? btn.classList.add('active') : btn.classList.remove('active'));
        }

        function buyProduct(n, p) {
            if (!document.getElementById('agreeCheck').checked) {
                pendingItem = { name: n, price: p };
                openModal();
                return;
            }
            window.open(`https://wa.me/${myWhatsApp}?text=I am interested in ${n} (N${p})`);
        }

        function openModal() {
            const overlay = document.getElementById('modalOverlay');
            overlay.classList.remove('hidden');
            overlay.classList.add('flex');
            setTimeout(() => document.getElementById('agreeModal').classList.add('active'), 50);
        }

        function closeModal() {
            document.getElementById('agreeModal').classList.remove('active');
            setTimeout(() => document.getElementById('modalOverlay').classList.replace('flex', 'hidden'), 400);
        }

        function acceptFromModal() {
            document.getElementById('agreeCheck').checked = true;
            toggleBuyButtons();
            closeModal();
            if (pendingItem) {
                buyProduct(pendingItem.name, pendingItem.price);
                pendingItem = null;
            }
        }

        function handleAdminTrigger() {
            clickCount++; clearTimeout(clickTimer);
            if (clickCount === 3) {
                const section = document.getElementById('featuredSection');
                section.classList.toggle('admin-active');
                document.querySelectorAll('.seller-name').forEach(n => n.contentEditable = section.classList.contains('admin-active'));
                clickCount = 0;
            } else { clickTimer = setTimeout(() => { clickCount = 0; }, 400); }
        }

        function previewBadge(input, id) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById(`${id}-img`).src = e.target.result;
                    document.getElementById(`${id}-img`).classList.remove('hidden');
                    document.getElementById(`${id}-icon`).classList.add('hidden');
                    localStorage.setItem(`jh_badge_${id}`, e.target.result);
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function loadAdminData() {
            const img = localStorage.getItem(`jh_badge_seller1`);
            if (img) {
                document.getElementById(`seller1-img`).src = img;
                document.getElementById(`seller1-img`).classList.remove('hidden');
                document.getElementById(`seller1-icon`).classList.add('hidden');
            }
        }

        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark');
            document.getElementById('themeIcon').className = isDarkMode ? 'fas fa-sun text-yellow-400' : 'fas fa-moon text-white';
        }
    </script>
</body>
</html>
