<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JOBHUB | Market</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --brand: #4A148C; --brand-light: #7B1FA2; --off-white: #F9F9F9; }
        body { background-color: var(--off-white); font-family: sans-serif; transition: background-color 0.3s, color 0.3s; }
        
        .dark { background-color: #121212; color: white; }
        .dark .bg-white { background-color: #1E1E1E; }

        .slogan-text {
            font-family: 'Arial Black', sans-serif;
            font-weight: 900; font-style: italic; letter-spacing: -1px;
            background: linear-gradient(to right, #FFFFFF 20%, #E1BEE7 40%, #BA68C8 50%, #E1BEE7 60%, #FFFFFF 80%);
            background-size: 200% auto; -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            animation: shine 3s linear infinite;
        }
        @keyframes shine { to { background-position: 200% center; } }

        .price-text { color: #2E7D32; font-size: 1.2rem; font-weight: 900; }
        .dark .price-text { color: #4ADE80; }

        /* SEARCH BAR */
        .search-container { margin: -25px 20px 0 20px; position: relative; z-index: 60; }
        .search-input {
            width: 100%; padding: 14px 45px; border-radius: 20px; border: none;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); outline: none; font-size: 14px; background: white;
        }
        .dark .search-input { background: #2D2D2D; color: white; }

        /* SELLER CAROUSEL */
        .featured-banner {
            background: linear-gradient(135deg, #4A148C 0%, #7B1FA2 100%);
            border-radius: 24px; padding: 20px; margin: 0 16px 20px 16px; color: white;
        }
        .featured-scroll { display: flex; gap: 15px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; }
        .featured-scroll::-webkit-scrollbar { display: none; }
        
        .seller-badge {
            flex: 0 0 110px; background: rgba(255,255,255,0.1); padding: 12px;
            border-radius: 20px; text-align: center; border: 1px solid rgba(255,255,255,0.2); position: relative;
        }
        
        .badge-img-container {
            width: 55px; height: 55px; background: rgba(255,255,255,0.2); 
            border-radius: 50%; margin: 0 auto 8px auto; overflow: hidden;
            border: 2px solid rgba(255,255,255,0.5); position: relative;
            display: flex; align-items: center; justify-content: center;
        }
        .badge-img-container img { width: 100%; height: 100%; object-fit: cover; }

        /* BUY BUTTON LOGIC */
        .buy-btn {
            width: 100%; padding: 10px 0; background-color: #25D366; color: white; 
            font-size: 10px; font-weight: 900; border-radius: 12px; 
            text-transform: uppercase; transition: all 0.3s;
            opacity: 0.2; cursor: not-allowed;
        }
        .buy-btn.active { opacity: 1; cursor: pointer; box-shadow: 0 4px 12px rgba(37, 211, 102, 0.4); }

        /* ADMIN */
        .upload-input { display: none; position: absolute; inset: 0; opacity: 0; cursor: pointer; z-index: 10; }
        .admin-active .upload-input { display: block; }
        .admin-active .seller-name { border: 1px dashed white; background: rgba(0,0,0,0.2); }
    </style>
</head>
<body class="pb-32">

    <header class="bg-[#4A148C] p-5 pb-12 space-y-6 shadow-lg sticky top-0 z-50 rounded-b-[35px]">
        <div class="flex justify-between items-center text-white">
            <h1 class="font-black italic text-2xl tracking-tighter">JOBHUB</h1>
            <button onclick="toggleDarkMode()" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center">
                <i class="fas fa-moon" id="themeIcon"></i>
            </button>
        </div>
        <div class="text-center py-2">
            <h2 class="slogan-text text-xl uppercase">KANO SHOPPING MADE EASY</h2>
        </div>
    </header>

    <div class="search-container">
        <i class="fas fa-search absolute left-5 top-1/2 -translate-y-1/2 text-gray-400"></i>
        <input type="text" id="searchInput" onkeyup="searchProducts()" placeholder="Search items in Kano..." class="search-input">
    </div>

    <section class="mt-8" id="featuredSection">
        <div class="featured-banner shadow-xl">
            <div class="flex justify-between items-center mb-4">
                <h3 id="adminLabel" onclick="handleAdminTrigger()" class="font-black uppercase text-[12px] tracking-widest italic cursor-pointer select-none">
                    <i class="fas fa-star text-yellow-400 mr-2"></i>Top Sellers
                </h3>
                <span id="adminStatus" class="text-[9px] bg-white/20 px-2 py-1 rounded-full uppercase font-bold tracking-tighter">Verified</span>
            </div>
            <div class="featured-scroll" id="sellerContainer">
                </div>
        </div>
    </section>

    <main class="px-4">
        <div id="shopGrid" class="grid grid-cols-2 gap-4">
            </div>

        <div class="mt-10 p-6 rounded-3xl bg-white border dark:bg-zinc-900 dark:border-zinc-800">
            <h4 class="font-black uppercase mb-3 text-[#4A148C] dark:text-purple-400 text-xs">Security Agreement</h4>
            <p class="text-[10px] text-gray-500 mb-4">Agreement required to unlock WhatsApp Buy buttons.</p>
            
            <div class="flex items-center gap-3 p-4 border-t dark:border-zinc-800">
                <input type="checkbox" id="agreeCheck" onchange="updateButtonStatus()" class="w-5 h-5 accent-purple-800">
                <label for="agreeCheck" class="font-bold text-gray-700 dark:text-gray-300 uppercase text-[9px]">I Agree to the safety rules</label>
            </div>
        </div>
    </main>

    <nav class="fixed bottom-0 w-full bg-white border-t flex justify-around items-center py-4 z-50 dark:bg-[#1E1E1E] dark:border-zinc-800">
        <div class="flex flex-col items-center text-[#4A148C]"><i class="fas fa-store text-xl"></i><span class="text-[10px] font-bold">Market</span></div>
        <div onclick="window.open('https://wa.me/2347051337399')" class="flex flex-col items-center text-gray-400 cursor-pointer"><i class="fab fa-whatsapp text-xl"></i><span class="text-[10px] font-bold">Chat</span></div>
    </nav>

    <script>
        const myWhatsApp = "2347051337399";
        let isDarkMode = false;
        let clickCount = 0;
        let clickTimer;

        // Run this immediately on load
        window.onload = () => {
            initSellers();
            renderProducts();
            loadAdminData();
        };

        function initSellers() {
            const container = document.getElementById('sellerContainer');
            container.innerHTML = '';
            for (let i = 1; i <= 10; i++) {
                container.innerHTML += `
                <div class="seller-badge">
                    <div class="badge-img-container">
                        <input type="file" class="upload-input" onchange="previewBadge(this, 's${i}')">
                        <i id="s${i}-icon" class="fas fa-user-tie text-white/50 text-xl"></i>
                        <img id="s${i}-img" src="" class="hidden">
                    </div>
                    <p id="s${i}-name" class="seller-name text-[9px] font-black uppercase truncate mb-1">Seller ${i}</p>
                    <button class="bg-black text-white text-[8px] px-3 py-1 rounded-full dark:bg-white dark:text-black">Visit</button>
                </div>`;
            }
        }

        function renderProducts() {
            const grid = document.getElementById('shopGrid');
            const isAgreed = document.getElementById('agreeCheck').checked;
            grid.innerHTML = '';
            const items = ["iPhone 12", "Sneakers", "Smart Watch", "Designer Cap", "Power Bank", "Laptop", "Perfume", "Wireless Buds"];
            
            items.forEach((item, i) => {
                const price = (i + 2) * 2500;
                grid.innerHTML += `
                <div class="bg-white p-3 rounded-3xl shadow-sm border dark:bg-zinc-900 dark:border-zinc-800">
                    <div class="h-32 bg-gray-100 rounded-2xl mb-2 flex items-center justify-center overflow-hidden">
                        <img src="https://via.placeholder.com/150?text=${item}" class="w-full h-full object-cover">
                    </div>
                    <h3 class="text-[11px] font-bold truncate mb-1 dark:text-white">${item}</h3>
                    <div class="price-text mb-2 text-sm">â‚¦${price.toLocaleString()}</div>
                    <button onclick="handleBuy('${item}', '${price}')" class="buy-btn ${isAgreed ? 'active' : ''}">
                        WhatsApp Buy
                    </button>
                </div>`;
            });
        }

        function updateButtonStatus() {
            const isAgreed = document.getElementById('agreeCheck').checked;
            document.querySelectorAll('.buy-btn').forEach(btn => {
                isAgreed ? btn.classList.add('active') : btn.classList.remove('active');
            });
        }

        function handleBuy(name, price) {
            if (!document.getElementById('agreeCheck').checked) {
                alert("Please agree to terms first!");
                return;
            }
            window.open(`https://wa.me/${myWhatsApp}?text=I want to buy ${name} (N${price})`);
        }

        function handleAdminTrigger() {
            clickCount++;
            clearTimeout(clickTimer);
            if (clickCount === 3) {
                const section = document.getElementById('featuredSection');
                section.classList.toggle('admin-active');
                const isAdmin = section.classList.contains('admin-active');
                document.getElementById('adminStatus').innerText = isAdmin ? "ADMIN MODE" : "Verified";
                document.querySelectorAll('.seller-name').forEach(n => {
                    n.contentEditable = isAdmin;
                    n.onblur = () => localStorage.setItem(`name_${n.id}`, n.innerText);
                });
                clickCount = 0;
            } else {
                clickTimer = setTimeout(() => { clickCount = 0; }, 400);
            }
        }

        function previewBadge(input, id) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById(`${id}-img`).src = e.target.result;
                    document.getElementById(`${id}-img`).classList.remove('hidden');
                    document.getElementById(`${id}-icon`).classList.add('hidden');
                    localStorage.setItem(`img_${id}`, e.target.result);
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function loadAdminData() {
            for (let i = 1; i <= 10; i++) {
                const img = localStorage.getItem(`img_s${i}`);
                if (img) {
                    document.getElementById(`s${i}-img`).src = img;
                    document.getElementById(`s${i}-img`).classList.remove('hidden');
                    document.getElementById(`s${i}-icon`).classList.add('hidden');
                }
                const name = localStorage.getItem(`name_s${i}-name`);
                if (name) document.getElementById(`s${i}-name`).innerText = name;
            }
        }

        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark');
            document.getElementById('themeIcon').className = isDarkMode ? 'fas fa-sun text-yellow-400' : 'fas fa-moon text-white';
        }

        function searchProducts() {
            const val = document.getElementById('searchInput').value.toLowerCase();
            document.querySelectorAll('#shopGrid > div').forEach(card => {
                const text = card.querySelector('h3').innerText.toLowerCase();
                card.style.display = text.includes(val) ? "block" : "none";
            });
        }
    </script>
</body>
</html>
